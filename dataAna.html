<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>博慧斯数据管理平台</title>
    <link rel="stylesheet" href="lib/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="lib/bootstrap/css/bootstrap-table.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="lib/jqplot/jquery.jqplot.min.css">
    <script src="lib/jqplot/jquery.min.js"></script>
    <script src="lib/jqplot/jquery.jqplot.min.js"></script>
    <script src="lib/jqplot/jqplot.barRenderer.js"></script>
    <script src="lib/jqplot/jqplot.categoryAxisRenderer.js"></script>
    <script src="lib/jqplot/jqplot.pointLabels.js"></script>
</head>
<body>
<header>
    <h1><a href="#">博慧斯</a></h1>
    <ul class="menu">
        <li><a href="index.html"><div class="menu-1"></div>
            <br/>首页</a></li>
        <li class="ck"><a href="#"><div class="menu-2"></div>
            <br/>数据分析</a></li>
        <li><a href="misMap.html"><div class="menu-3"></div>
            <br/>糖化中国</a></li>
        <li><a href="savePage.html"><div class="menu-4"></div>
            <br/>系统设置</a></li>
    </ul>
    <ul class="login">
        <li><a href="#"><img src="images/login-01.png" alt="">&nbsp;管理员登录&nbsp;</a></li>
        <li><a href="#"><img src="images/login-02.png" alt="">&nbsp;退出&nbsp;</a></li>
    </ul>
</header>
<div class="main">
    <h3>数据统计分析: </h3>
    <div class="box">
        <input type="text" id="search_01" placeholder="请输入年月:2017/06"/>
        <a href="javascript:;" class="btn btn-primary" id="search_02">搜索</a>
        <div id="chart1"></div>
        <div id="chart2"></div>
    </div>
</div>
<script>
    $(function(){
        var searchTime;
        var url = "api/api-01.php";
        $("#search_02").on("click",function () {
           searchTime = $("#search_01").val();
            url = "api/api-02.php";
            plot1.destroy();
            plot2.destroy();
            ajaxHandle();
        });
        var plot1;
        var plot2;
            ajaxHandle();
        function ajaxHandle() {
            $.ajax({
                url: url,
                type: "get",
                data: {
                    searchTime: searchTime
                },
                success: function (data) {
                    var s1 = data.a1c;
                    var s2 = data.glucos;
                    var ticks = data.days;
                    plot1 = $.jqplot('chart1', [s1], {
                        title: "每日糖化收到数据量统计图",
                        captureRightClick: true,
                        seriesDefaults: {
                            renderer:$.jqplot.BarRenderer,
                            pointLabels: { show: true }
                        },
                        axes: {
                            xaxis: {
                                renderer: $.jqplot.CategoryAxisRenderer,
                                ticks: ticks
                            }
                        }
                    });
                    plot2 = $.jqplot('chart2', [s2], {
                        title: "每日血糖收到数据量统计图",
                        captureRightClick: true,
                        seriesDefaults: {
                            renderer:$.jqplot.BarRenderer,
                            pointLabels: { show: true }
                        },
                        axes: {
                            xaxis: {
                                renderer: $.jqplot.CategoryAxisRenderer,
                                ticks: ticks
                            }
                        }
                    });
                }
            });
        }
    });
</script>
</body>
</html>